<app-menu (toggleGridEvent)="toggleGrid($event)">
</app-menu>
<div class="placefornav">

</div>
<div class="container vertical-align" *ngIf="files?.length == 0 && folders?.length == 0">
  <div class="align-center">
    <div class="success">Вы успешно зарегистрированы!</div>
    <div class="row">
      <div class="text">Теперь вы можете начать использовать LOGO! <br>Загружайте свои файлы и делитесь ими <br>с остальными пользователями!</div>
    </div>
    <div class="col-sm-8 col-sm-offset-2">
      <div class="col-md-6 col-md-offset-3">
        <button class="button-color" data-toggle="modal" data-target="#uploadFileModal">Загрузить файл</button>
      </div>
      <div class="col-md-6 col-md-offset-3">
        <button class="button" data-toggle="modal" data-target="#createFolderModal">Создать папку</button>
      </div>
    </div>
  </div>
</div>

<div class="col-sm-9 container-for-ff">
  <div *ngIf="grid">это грид</div>
  <div *ngIf="!grid">это не грид</div>
  <div *ngIf="folders?.length > 0">
    <div class="title-f">Папки</div>
    <div class="row">
      <div class="col-xs-3" *ngFor="let folder of folders">
        <div class="folder-grid" [contextMenu]="static" (dblclick)="moveToSelectedFolder(folder.folderId)">

          <div class="folder-grid-item">
            <img src="assets\icons\folder.svg" class="img-folder"> {{folder.name}}
          </div>

          <button id="openRenameFolderModalButton" hidden="true" data-toggle="modal" data-target="#renameFolderModal">Переименовать</button>
          <button id="openAddTagFolderModalButton" hidden="true" data-toggle="modal" data-target="#addTagFolderModal">Добавить тег</button>
          <button id="openDeleteFolderModalButton" hidden="true" data-toggle="modal" data-target="#deleteFolderModal">Удалить папку</button>
          <context-menu #static>
            <ng-template contextMenuItem (execute)="openRenameFolderModal(folder.folderId)">
              Переименовать
            </ng-template>
            <ng-template contextMenuItem (execute)="openAddTagFolderModal(folder.folderId)">
              Добавить тег
            </ng-template>
            <ng-template contextMenuItem (execute)="callDownloadZIP(folder.folderId)">
              Скачать ZIP-архив
            </ng-template>
            <ng-template contextMenuItem (execute)="openDeleteFolderModal(folder.folderId)">
              Удалить папку
            </ng-template>
          </context-menu>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="files?.length > 0">
    <div class="title-f">Файлы</div>
    <div class="row">
      <div class="col-md-3" *ngFor="let file of files">
        <div class="thumbnail" class="folder-grid">
          <div class="folder-grid-item">
            <img src="assets\icons\picture.svg" class="img-folder"> {{file.name}}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="col-sm-3" *ngIf="folders?.length > 0 || files?.length > 0">
  <div class="button-group-right">
    <div>
      <button class="button-color" data-toggle="modal" data-target="#uploadFileModal">Загрузить файл</button>
    </div>
    <div>
      <button class="button" data-toggle="modal" data-target="#createFolderModal">Создать папку</button>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="createFolderModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content custom-modal">
      <div class="modal-header custom-header">
        <h4 class="modal-title">Создание папки</h4>
      </div>
      <div class="modal-body">
        <form name="form" (ngSubmit)="formCreate.form.valid && createfolder()" #formCreate="ngForm" novalidate>
          <div class="form-group" [ngClass]="{ 'has-error': formCreate.submitted && !foldername.valid }">
            <label for="foldername"></label>
            <input type="text" class="form-control form-control-on-add-folder" name="foldername" placeholder="Имя папки" [(ngModel)]="model.foldername"
              #foldername="ngModel" required maxlength="50" />
            <div *ngIf="formCreate.submitted && foldername.errors && (foldername.dirty || foldername.touched)" class="alerts"><br>
              <div [hidden]="!foldername.errors.required">
                Имя папки необходимо.
              </div>
              <div [hidden]="!foldername.errors.maxlength">
                Максимальная длинна папки 50 символов.
              </div>
            </div>
            <!-- <div *ngIf="f.submitted && !name.valid" class="help-block">Имя пользователя необходимо</div> -->
          </div>
          <div class="form-group">
            <button class="button-transparent" data-dismiss="modal" #closeBtn>Отмена</button>
            <button class="button-color">Готово</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>



<!-- Modal -->
<div class="modal fade" id="uploadFileModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content custom-modal">
      <div class="modal-header custom-header">
        <h4 class="modal-title">Загрузка файлов</h4>
      </div>
      <div class="modal-body">
        <div class="file_upload">
          <button type="button">Выбрать</button>

          <input type="file" #inputfiles (change)="onChange(inputfiles.files)" placeholder="Upload file" accept=".jpg,.png,.avi" multiple>
        </div>
        <table class="table">
          <tbody>
            <tr *ngFor="let f of uploadFiles; let i = index">
              <td><img src="assets\icons\success.svg" width="20" height="20"></td>
              <td><img src="assets\icons\picture.svg" width="20" height="20" *ngIf="checkIfImage(f.name)">
                <img src="assets\icons\video-player.svg" width="20" height="20" *ngIf="!checkIfImage(f.name)"></td>
              <td class="name-file-in-table">{{f.name}}</td>
              <td>
                <form name="form" (ngSubmit)="frm.form.valid" #frm="ngForm" novalidate>
                  <div [ngClass]="{ 'has-error': frm.submitted && !hashtag.valid }">
                    <input type="text" class="form-control-on-upload-file" name="f.name-{{i}}" placeholder="+Добавить тег" [(ngModel)]="f.hashtag"
                      #hashtag="ngModel" />
                    <div *ngIf="hashtag.errors && (hashtag.dirty && hashtag.touched)" class="alerts"><br>
                      <div [hidden]="!hashtag.errors">
                        Введите корректный тег.
                      </div>
                    </div>
                  </div>
                </form>
              </td>

            </tr>
          </tbody>
        </table>
        <button class="button-transparent" data-dismiss="modal" #closeBtn>Отмена</button>
        <button class="button-color">Готово</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="renameFolderModal" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content custom-modal">
      <div class="modal-header custom-header">
        <h4 class="modal-title">Переименовать папку</h4>
      </div>
      <div class="modal-body">
        <form name="formrenamev" (ngSubmit)="formrename.valid && renamefolder()" #formrename="ngForm" novalidate>
          <div class="form-group" [ngClass]="{ 'has-error': formrename.submitted && !folderrename.valid }">
            <label for="folderrename"></label>
            <input type="text" class="form-control form-control-on-add-folder" name="folderrename" placeholder="Имя папки" [(ngModel)]="folderrenamem.name"
              #folderrename="ngModel" required maxlength="50" />
            <div *ngIf="formrename.submitted && folderrename.errors && (folderrename.dirty || folderrename.touched)" class="alerts"><br>
              <div [hidden]="!folderrename.errors.required">
                Имя папки необходимо.
              </div>
              <div [hidden]="!folderrename.errors.maxlength">
                Максимальная длинна папки 50 символов.
              </div>
            </div>
            <!-- <div *ngIf="f.submitted && !name.valid" class="help-block">Имя пользователя необходимо</div> -->
          </div>
          <div class="form-group">
            <button class="button-transparent" data-dismiss="modal" #closeBtn>Отмена</button>
            <button class="button-color">Готово</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="addTagFolderModal" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content custom-modal">
      <div class="modal-header custom-header">
        <h4 class="modal-title">Добавить тег
          <a href="/" class="img-tag"><img src="assets\icons\tag-black-shape.svg" class="img-tag pull-right"></a>
        </h4>
      </div>
      <div class="modal-body">

        <form name="form" (ngSubmit)="f.form.valid && addTags()" #f="ngForm" novalidate>
          <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !tags.valid }">
            <label for="tags"></label>
            <textarea cols="40" rows="5" class="form-control huge-input" [(ngModel)]="model.tags" name="tags" id="tags" #tags="ngModel"
              required></textarea>

            <div *ngIf="f.submitted && !tags.valid" class="help-block">Имя пользователя необходимо</div>
          </div>
          <div class="form-group right">
            <button class="button-transparent" *ngIf="false" data-dismiss="modal" #closeBtn>Отмена</button>
            <span class="max-tag-text pull-left">Максимальное <br>количество тегов - 200</span>
            <button class="button-color">Добавить</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="deleteFolderModal" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content custom-modal">
      <div class="modal-body" padding="30">
        <div class="text-deleted">Вы уверенны, что хотите удалить эту папку?</div>
        <div class="form-group">
          <button class="button-transparent" data-dismiss="modal" #closeBtn>Ой, нет!</button>
          <button class="button-color" (click)="deleteFolder()">Да, удалить</button>
        </div>
      </div>
    </div>
  </div>
</div>